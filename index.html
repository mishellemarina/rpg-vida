<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Tu Vida, Tu Juego - RPG</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f5f5f5;
      padding: 20px;
      max-width: 800px;
      margin: auto;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    .auth-container {
      text-align: center;
      margin-bottom: 30px;
    }

    input, button {
      margin: 5px;
      padding: 10px;
      font-size: 1em;
    }

    .hidden {
      display: none;
    }

    .stats-container, .activities-container {
      display: none;
    }
  </style>
</head>
<body>
  <header>
    <h1>游꿡 Tu Vida, Tu Juego</h1>
    <p>Gamifica tu vida como si fuera un RPG</p>
  </header>

  <div class="auth-container">
    <input type="email" id="email" placeholder="Correo electr칩nico" />
    <input type="password" id="password" placeholder="Contrase침a" />
    <br/>
    <button id="register-btn">Registrarse</button>
    <button id="login-btn">Iniciar sesi칩n</button>
    <button id="logout-btn" class="hidden">Cerrar sesi칩n</button>
  </div>

  <div class="stats-container" id="stats-container">
    <h2>游늵 Tus Estad칤sticas</h2>
    <p>Nivel: <span id="nivel">1</span></p>
    <p>XP: <span id="xp">0</span></p>
    <!-- Aqu칤 podr칤as a침adir m치s stats -->
  </div>

  <div class="activities-container" id="activities-container">
    <h2>游늶 Registrar Actividad</h2>
    <form id="activity-form">
      <input type="text" id="activity-name" placeholder="Actividad" required />
      <select id="activity-stat">
        <option value="fuerza">Fuerza</option>
        <option value="creatividad">Creatividad</option>
        <option value="inteligencia">Inteligencia</option>
      </select>
      <select id="activity-xp">
        <option value="10">F치cil (+10 XP)</option>
        <option value="20">Media (+20 XP)</option>
        <option value="30">Dif칤cil (+30 XP)</option>
      </select>
      <button type="submit">Guardar</button>
    </form>

    <div id="activity-list"></div>
  </div>

  <script type="module">
    // 游댢 CONFIGURACI칍N DE FIREBASE - CAMBIA ESTO
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, setDoc } from "https://www.gstatic.com/firebasejs/10.10.0/firebase-firestore.js";

    const firebaseConfig = {
      "type": "service_account",
      "project_id": "rpg-dmon",
      "private_key_id": "bc480c9e3fe23520dc2444a800cbd1c99c0555bb",
      "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDqOFitKsUP6zng\nj+L/VOr3FXh5qsmB4k1k5YyweSaiBnsclHS97xKPMikLaRNisKEHfqzpQK/M9Ax8\nRSLfO7nYRMbOGjldYx8YdeUnLFnMPSg1Qs/rQJVuxHO8T0ivoO3Jcn6+jD8Kcbes\nxvq3cqkSlLd+PpYyIWsqJvhMJTVOjwST9cxUh2oY4MRF5SqBdof4WM0Fjn8ZZ6Gx\nyNwhenOUzNGZMQN2vqBzgfX+3HHGV95t9TQKZHt+yMu5KKFpDJEFDtzlo9uGmmlF\n8Y+rb5UoCVpJAkBAdiatavwSojGS2Ce5fPbVPhXs+9DVVBO6Gr5xh/6BqoGCpYXf\n2+e3atZLAgMBAAECggEANHkkMMOMu6jE4jEKN470Rx/ZylQ/aehj0290ChNSWuld\nyoTd9LFrdIZV2LcVPz54DSBNp8I0wJOKeorYqa+NTsz1xzXr1SbAUDAVgyW2BoJL\nEEekIj3pXJQJo84VaDeDHmcWyyTLeNEKR9yaTeATzdRgmZl298sx4ZMyfIi3fR4y\nuwH8+sepwDCirTtnxXY2nVL1gAVYjcKStnGDJ3XEL/OGx1ArUYCZOPLQlaAYgzJ1\ns9F5zV+nKO3rYQkDPIWNRxbYkg0O9wzOqE1UcdPVaVdWo7qCnaB2Q4/0/R/jpIo/\nXWHrOZNy86OGsqmU/KLHi2Lp++PqhOZxjRGI3ENtuQKBgQD4VVCyZ/H3eYf9awOu\nkVqlVqizDCqBS39JYwiSBTouqWf73eXy0mKz9L98Q4UlMOlpn2LYsntXnTTuhaai\nqaaYzMdTugq8hazcJKKEGbzku8ibuFyzGlbkwDAOntc/4ewasWuOmRezEn+QTvP1\n72ZbpzMYgMhQ/suE8fSOvRSNwwKBgQDxc30hTbLBtGk/RLbWF3Yswkhe5d+9e2q/\nSF/cCgPBh2D8fng4ovc2Dj8NnSpUfFeJ7OpcjJE/AEEeElRaNMVEnudo7vaRTTaT\nwzMeGb59LR0h3DyVEjEUKFDlSn1ZuPqy1ZG2+8YzlWw/uDXpHVzdOJrGPS2TDmV/\nvTaEBX/k2QKBgDRXHwQLPoePeOcjyAniHv3cLwBV3xuTQwe/tM26BlJRaFZApbex\nOhZ9zmIthQGatoeJjXbo33BO9RoU11NPeIqaFqUCAENN1Wos2ogHOLXpElYn3Hnv\nYkMicr6SIgIX5wCVRnsurz0R+Ar9aRP72lIVAoL2mcHgghrKOGZhWdSrAoGAbtP2\nAc1qWeN30+S0j/zg75aWJYkadB0sWHTeG2A1bSW47O0YPdb/5j4Pzy3u+izA+bxX\nrveOy/5P5X/AXE+QpPjTe6UEZJmujZCx7AUhHNASaTJwVHSvNnNy/mx8sSxpVqEV\na4qR5aeWsoDZrhEeSSTsVkZKnw+io0m0tlDX7bECgYBAk+S8BaWRTvVSSkR7/IzP\nn+199DtOpSBU1eP6CQ/GfVf2b4SyAiduWP8OxiDHbmjZIVa1/sqwzCiKsYVHAm4j\nXB64798lzyGN4Q826OWOTOSdnwFvPkpyFGbkMzd+ByDjRujZzjpTUEVe1WKBSCMk\nPtrhez6DEhpa5+v5qi+A5g==\n-----END PRIVATE KEY-----\n",
      "client_email": "firebase-adminsdk-fbsvc@rpg-dmon.iam.gserviceaccount.com",
      "client_id": "114715894476114885543",
      "auth_uri": "https://accounts.google.com/o/oauth2/auth",
      "token_uri": "https://oauth2.googleapis.com/token",
      "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
      "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40rpg-dmon.iam.gserviceaccount.com",
      "universe_domain": "googleapis.com"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // Estado
    let state = {
      xp: 0,
      nivel: 1,
      stats: {
        fuerza: 0,
        creatividad: 0,
        inteligencia: 0
      },
      activities: []
    };

    function updateUI() {
      document.getElementById("nivel").textContent = state.nivel;
      document.getElementById("xp").textContent = state.xp;

      const list = document.getElementById("activity-list");
      list.innerHTML = "";
      state.activities.forEach(act => {
        const div = document.createElement("div");
        div.textContent = `${act.name} [+${act.xp} XP en ${act.stat}]`;
        list.appendChild(div);
      });
    }

    async function loadUserData(uid) {
      const ref = doc(db, "users", uid);
      const docSnap = await getDoc(ref);
      if (docSnap.exists()) {
        state = docSnap.data();
        updateUI();
      } else {
        await setDoc(ref, state);
      }
    }

    async function saveUserData(uid) {
      const ref = doc(db, "users", uid);
      await setDoc(ref, state);
    }

    // Eventos de formulario
    document.getElementById("activity-form").addEventListener("submit", async e => {
      e.preventDefault();

      const name = document.getElementById("activity-name").value;
      const stat = document.getElementById("activity-stat").value;
      const xp = parseInt(document.getElementById("activity-xp").value);

      state.xp += xp;
      state.stats[stat] += xp;
      state.activities.push({ name, stat, xp });

      state.nivel = Math.floor(Math.sqrt(state.xp / 100)) + 1;

      updateUI();
      const user = auth.currentUser;
      if (user) await saveUserData(user.uid);

      e.target.reset();
    });

    // Autenticaci칩n
    document.getElementById("register-btn").addEventListener("click", () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      createUserWithEmailAndPassword(auth, email, password).catch(alert);
    });

    document.getElementById("login-btn").addEventListener("click", () => {
      const email = document.getElementById("email").value;
      const password = document.getElementById("password").value;
      signInWithEmailAndPassword(auth, email, password).catch(alert);
    });

    document.getElementById("logout-btn").addEventListener("click", () => {
      signOut(auth);
    });

    // Control de estado de usuario
    onAuthStateChanged(auth, async user => {
      if (user) {
        await loadUserData(user.uid);
        document.getElementById("stats-container").style.display = "block";
        document.getElementById("activities-container").style.display = "block";
        document.getElementById("logout-btn").classList.remove("hidden");
        document.getElementById("login-btn").classList.add("hidden");
        document.getElementById("register-btn").classList.add("hidden");
      } else {
        document.getElementById("stats-container").style.display = "none";
        document.getElementById("activities-container").style.display = "none";
        document.getElementById("logout-btn").classList.add("hidden");
        document.getElementById("login-btn").classList.remove("hidden");
        document.getElementById("register-btn").classList.remove("hidden");
      }
    });
  </script>
</body>
</html>
