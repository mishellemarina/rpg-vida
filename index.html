DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mi Sistema RPG</title>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #1e1e2f;
      color: #fff;
      padding: 20px;
    }
    input, button {
      padding: 10px;
      margin: 5px;
      border: none;
      border-radius: 5px;
    }
    button {
      background-color: #4caf50;
      color: white;
      cursor: pointer;
    }
    .stars span {
      font-size: 20px;
      margin-right: 3px;
    }
  </style>
</head>
<body>

  <h1>Mi Sistema de RPG</h1>

  <!-- üîê LOGIN FIREBASE -->
  <div id="auth-section">
    <input id="email" type="email" placeholder="Correo" />
    <input id="password" type="password" placeholder="Contrase√±a" />
    <button id="login-btn">Iniciar Sesi√≥n</button>
    <button id="signup-btn">Crear Cuenta</button>
    <button id="logout-btn" style="display:none;">Cerrar Sesi√≥n</button>
  </div>

  <!-- üßô‚Äç‚ôÇÔ∏è PROGRESO RPG -->
  <div id="rpg-section" style="display:none;">
    <p>XP: <span id="xp">0</span></p>
    <p>Nivel: <span id="nivel">1</span></p>

    <div id="stats">
      <p>Fuerza: <span id="fuerza">0</span> <span class="stars" id="stars-fuerza"></span></p>
      <p>Creatividad: <span id="creatividad">0</span> <span class="stars" id="stars-creatividad"></span></p>
      <p>Inteligencia: <span id="inteligencia">0</span> <span class="stars" id="stars-inteligencia"></span></p>
      <p>Social: <span id="social">0</span> <span class="stars" id="stars-social"></span></p>
      <p>Belleza: <span id="belleza">0</span> <span class="stars" id="stars-belleza"></span></p>
    </div>

    <!-- üéØ FORMULARIO DE ACCI√ìN -->
    <form id="activity-form">
      <input type="text" id="desc" placeholder="¬øQu√© hiciste?" required />
      <input type="number" id="xpInput" placeholder="XP ganada" required />
      <select id="stat">
        <option value="fuerza">Fuerza</option>
        <option value="creatividad">Creatividad</option>
        <option value="inteligencia">Inteligencia</option>
        <option value="social">Social</option>
        <option value="belleza">Belleza</option>
      </select>
      <button type="submit">A√±adir Actividad</button>
    </form>

    <ul id="activity-list"></ul>
  </div>

  <!-- üî• FIREBASE + SCRIPT RPG -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-app.js";
    import {
      getAuth, onAuthStateChanged,
      signInWithEmailAndPassword,
      createUserWithEmailAndPassword,
      signOut
    } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-auth.js";
    import {
      getFirestore, doc, setDoc, getDoc
    } from "https://www.gstatic.com/firebasejs/10.11.0/firebase-firestore.js";

    // ‚ö†Ô∏è‚ö†Ô∏è CAMBIA ESTO CON TUS DATOS DE FIREBASE ‚ö†Ô∏è‚ö†Ô∏è
    const firebaseConfig = {
      "type": "service_account",
      "project_id": "rpg-dmon",
      "private_key_id": "bc480c9e3fe23520dc2444a800cbd1c99c0555bb",
      "private_key": "-----BEGIN PRIVATE KEY-----\nMIIEvAIBADANBgkqhkiG9w0BAQEFAASCBKYwggSiAgEAAoIBAQDqOFitKsUP6zng\nj+L/VOr3FXh5qsmB4k1k5YyweSaiBnsclHS97xKPMikLaRNisKEHfqzpQK/M9Ax8\nRSLfO7nYRMbOGjldYx8YdeUnLFnMPSg1Qs/rQJVuxHO8T0ivoO3Jcn6+jD8Kcbes\nxvq3cqkSlLd+PpYyIWsqJvhMJTVOjwST9cxUh2oY4MRF5SqBdof4WM0Fjn8ZZ6Gx\nyNwhenOUzNGZMQN2vqBzgfX+3HHGV95t9TQKZHt+yMu5KKFpDJEFDtzlo9uGmmlF\n8Y+rb5UoCVpJAkBAdiatavwSojGS2Ce5fPbVPhXs+9DVVBO6Gr5xh/6BqoGCpYXf\n2+e3atZLAgMBAAECggEANHkkMMOMu6jE4jEKN470Rx/ZylQ/aehj0290ChNSWuld\nyoTd9LFrdIZV2LcVPz54DSBNp8I0wJOKeorYqa+NTsz1xzXr1SbAUDAVgyW2BoJL\nEEekIj3pXJQJo84VaDeDHmcWyyTLeNEKR9yaTeATzdRgmZl298sx4ZMyfIi3fR4y\nuwH8+sepwDCirTtnxXY2nVL1gAVYjcKStnGDJ3XEL/OGx1ArUYCZOPLQlaAYgzJ1\ns9F5zV+nKO3rYQkDPIWNRxbYkg0O9wzOqE1UcdPVaVdWo7qCnaB2Q4/0/R/jpIo/\nXWHrOZNy86OGsqmU/KLHi2Lp++PqhOZxjRGI3ENtuQKBgQD4VVCyZ/H3eYf9awOu\nkVqlVqizDCqBS39JYwiSBTouqWf73eXy0mKz9L98Q4UlMOlpn2LYsntXnTTuhaai\nqaaYzMdTugq8hazcJKKEGbzku8ibuFyzGlbkwDAOntc/4ewasWuOmRezEn+QTvP1\n72ZbpzMYgMhQ/suE8fSOvRSNwwKBgQDxc30hTbLBtGk/RLbWF3Yswkhe5d+9e2q/\nSF/cCgPBh2D8fng4ovc2Dj8NnSpUfFeJ7OpcjJE/AEEeElRaNMVEnudo7vaRTTaT\nwzMeGb59LR0h3DyVEjEUKFDlSn1ZuPqy1ZG2+8YzlWw/uDXpHVzdOJrGPS2TDmV/\nvTaEBX/k2QKBgDRXHwQLPoePeOcjyAniHv3cLwBV3xuTQwe/tM26BlJRaFZApbex\nOhZ9zmIthQGatoeJjXbo33BO9RoU11NPeIqaFqUCAENN1Wos2ogHOLXpElYn3Hnv\nYkMicr6SIgIX5wCVRnsurz0R+Ar9aRP72lIVAoL2mcHgghrKOGZhWdSrAoGAbtP2\nAc1qWeN30+S0j/zg75aWJYkadB0sWHTeG2A1bSW47O0YPdb/5j4Pzy3u+izA+bxX\nrveOy/5P5X/AXE+QpPjTe6UEZJmujZCx7AUhHNASaTJwVHSvNnNy/mx8sSxpVqEV\na4qR5aeWsoDZrhEeSSTsVkZKnw+io0m0tlDX7bECgYBAk+S8BaWRTvVSSkR7/IzP\nn+199DtOpSBU1eP6CQ/GfVf2b4SyAiduWP8OxiDHbmjZIVa1/sqwzCiKsYVHAm4j\nXB64798lzyGN4Q826OWOTOSdnwFvPkpyFGbkMzd+ByDjRujZzjpTUEVe1WKBSCMk\nPtrhez6DEhpa5+v5qi+A5g==\n-----END PRIVATE KEY-----\n",
      "client_email": "firebase-adminsdk-fbsvc@rpg-dmon.iam.gserviceaccount.com",
      "client_id": "114715894476114885543",
      "auth_uri": "https://accounts.google.com/o/oauth2/auth",
      "token_uri": "https://oauth2.googleapis.com/token",
      "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
      "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-fbsvc%40rpg-dmon.iam.gserviceaccount.com",
      "universe_domain": "googleapis.com"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    const state = {
      xp: 0,
      nivel: 1,
      stats: {
        fuerza: 0,
        creatividad: 0,
        inteligencia: 0,
        social: 0,
        belleza: 0
      },
      activities: []
    };

    function calculateLevel() {
      state.nivel = Math.floor(state.xp / 100) + 1;
    }

    function updateStars(stat, value) {
      const container = document.getElementById(`stars-${stat}`);
      container.innerHTML = '';
      const starTypes = ['ü•â', 'ü•à', 'ü•á', 'üèÜ', 'üåü'];
      const totalStars = Math.floor(value / 50);
      for (let i = 0; i < totalStars; i++) {
        const type = starTypes[Math.floor(i / 5)] || 'üåü';
        container.innerHTML += `<span>${type}</span>`;
      }
    }

    function updateUI() {
      document.getElementById("xp").textContent = state.xp;
      document.getElementById("nivel").textContent = state.nivel;

      for (let stat in state.stats) {
        document.getElementById(stat).textContent = state.stats[stat];
        updateStars(stat, state.stats[stat]);
      }

      const list = document.getElementById("activity-list");
      list.innerHTML = "";
      state.activities.forEach(act => {
        const li = document.createElement("li");
        li.textContent = `${act.desc} +${act.xp} XP en ${act.stat}`;
        list.appendChild(li);
      });
    }

    async function saveData(user) {
      if (user) {
        await setDoc(doc(db, "users", user.uid), state);
      }
    }

    async function loadData(user) {
      const docSnap = await getDoc(doc(db, "users", user.uid));
      if (docSnap.exists()) {
        Object.assign(state, docSnap.data());
        updateUI();
      }
    }

    onAuthStateChanged(auth, (user) => {
      if (user) {
        document.getElementById("auth-section").style.display = "none";
        document.getElementById("rpg-section").style.display = "block";
        loadData(user);
      } else {
        document.getElementById("auth-section").style.display = "block";
        document.getElementById("rpg-section").style.display = "none";
      }
    });

    document.getElementById("login-btn").onclick = () => {
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      signInWithEmailAndPassword(auth, email, pass)
        .catch(err => alert("Error al iniciar sesi√≥n: " + err.message));
    };

    document.getElementById("signup-btn").onclick = () => {
      const email = document.getElementById("email").value;
      const pass = document.getElementById("password").value;
      createUserWithEmailAndPassword(auth, email, pass)
        .catch(err => alert("Error al crear cuenta: " + err.message));
    };

    document.getElementById("logout-btn").onclick = () => signOut(auth);

    document.getElementById("activity-form").addEventListener("submit", e => {
      e.preventDefault();
      const desc = document.getElementById("desc").value;
      const xp = parseInt(document.getElementById("xpInput").value);
      const stat = document.getElementById("stat").value;

      state.xp += xp;
      state.stats[stat] += xp;
      state.activities.push({ desc, xp, stat });

      calculateLevel();
      updateUI();
      saveData(auth.currentUser);

      e.target.reset();
    });

  </script>
</body>
</html>

